<div *ngIf="!dataSource" class="d-flex justify-content-center align-items-center">
    <img class="text-bottom" width="500" height="300" src="assets/images/Data_not_found.png">
</div>
<div class="table">
    <table class="w-100" mat-table [dataSource]="dataSource" matSort #mytableb cellspacing="0" cellpadding="0">
        <ng-container *ngFor="let column of getDisplayedColumns()" [matColumnDef]="column">

            <th mat-header-cell *matHeaderCellDef>
                <strong class="d-flex justify-content-center"> {{ ( routeParam + '.' +  column) | translate }} </strong>
            </th>

            <form [formGroup]="tableForm" autocomplete="off">

                <td mat-cell *matCellDef="let element;" [ngSwitch]="element[column].type"
                    [ngStyle]="{'min-width': element[column].width + 'px'}">

                    <input *ngSwitchCase="'autoInc'" matInput  [disabled]="element[column].disabled"
                    [value]="dataSource.filteredData.indexOf(element) + 1" />

                    <mat-form-field class="form-element" *ngSwitchCase="'text'">
                        <input id="{{column}}{{dataSource.filteredData.indexOf(element)}}" matInput
                            [disabled]="element[column].disabled" [value]="element[column].value"
                            formControlName="{{column}}"
                            (input)="formControlValid(column, element, $event.target.value, dataSource.filteredData.indexOf(element));"
                            (keydown.enter)="setFocus(column, dataSource.filteredData.indexOf(element));" />
                    </mat-form-field>

                    <mat-form-field class="form-element" *ngSwitchCase="'number'">
                        <input id="{{column}}{{dataSource.filteredData.indexOf(element)}}" matInput type="number"
                            [disabled]="element[column].disabled" [value]="element[column].value"
                            (input)="formControlValid(column, element, $event.target.value, dataSource.filteredData.indexOf(element));"
                            (keydown.enter)="setFocus(column, dataSource.filteredData.indexOf(element));" />
                    </mat-form-field>

                    <mat-form-field class="form-element" *ngSwitchCase="'dropdown'">
                        <mat-select id="{{column}}{{dataSource.filteredData.indexOf(element)}}"
                            [disabled]="element[column].disabled"
                            (selectionChange)="formControlValid(column, element, $event.value, dataSource.filteredData.indexOf(element)); setFocus(column, dataSource.filteredData.indexOf(element));">
                            <mat-option>None</mat-option>
                            <mat-option *ngFor="let data of element[column].list" [value]="data[element[column].id]">
                                <span *ngIf="element[column].displayMul;else content">
                                    {{data[element[column].id]}} - {{data[element[column].text]}}
                                </span>
                                <ng-template #content> {{data[element[column].text]}} </ng-template>
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field class="form-element d-flex" *ngSwitchCase="'datepicker'">
                        <input id="{{column}}{{dataSource.filteredData.indexOf(element)}}" matInput
                            [matDatepicker]="picker" readonly (click)="picker.open()"
                            [disabled]="element[column].disabled"
                            (dateChange)="formControlValid(column, element, element[column].value, dataSource.filteredData.indexOf(element)); setFocus(column, dataSource.filteredData.indexOf(element));">
                        <mat-datepicker-toggle matSuffix [for]="picker">
                            <mat-icon matDatepickerToggleIcon class="mat--icon">date_range</mat-icon>
                        </mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>

                    <mat-form-field class="form-element" *ngSwitchCase="'autocomplete'">
                        <app-autocomplete id="{{column}}{{dataSource.filteredData.indexOf(element)}}"
                            [configData]="element[column]" [isDisabled]="element[column].disabled"
                            (emitTypeAheadValue)="setTypeAheadValue($event, column, dataSource.filteredData.indexOf(element)); setFocus(column, dataSource.filteredData.indexOf(element));">
                        </app-autocomplete>
                    </mat-form-field>

                    <div *ngSwitchCase="'none'">
                        <span> {{ element[column].value }} </span>
                    </div>

                    <mat-icon id="{{column}}{{dataSource.filteredData.indexOf(element)}}" *ngSwitchCase="'delete'"
                        [hidden]="dataSource.filteredData.indexOf(element) == (dataSource.data.length - 1)"
                        class="cursor--pointer mat--icon"
                        (click)="deleteRow(dataSource.filteredData.indexOf(element), element[column].disabled); setFocus(column, dataSource.filteredData.indexOf(element));">
                        delete</mat-icon>

                </td>
            </form>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="getDisplayedColumns()"></tr>
        <tr mat-row *matRowDef="let row; columns: getDisplayedColumns();"></tr>
    </table>
</div>